CPUDETECT                       Source Listing                   9-MAY-2021 23:42:40  VSI C V7.4-002-50R2O              Page 1
V1.0                                                             8-MAY-2021 19:05:55  cpudetect.c;2

	      1 /*
	      2  * THIS SOFTWARE IS SUBJECT TO COPYRIGHT PROTECTION AND IS OFFERED ONLY
	      3  * PURSUANT TO THE 3DFX GLIDE GENERAL PUBLIC LICENSE. THERE IS NO RIGHT
	      4  * TO USE THE GLIDE TRADEMARK WITHOUT PRIOR WRITTEN PERMISSION OF 3DFX
	      5  * INTERACTIVE, INC. A COPY OF THIS LICENSE MAY BE OBTAINED FROM THE 
	      6  * DISTRIBUTOR OR BY CONTACTING 3DFX INTERACTIVE INC(info@3dfx.com). 
	      7  * THIS PROGRAM IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER 
	      8  * EXPRESSED OR IMPLIED. SEE THE 3DFX GLIDE GENERAL PUBLIC LICENSE FOR A
	      9  * FULL TEXT OF THE NON-WARRANTY PROVISIONS.  
	     10  * 
	     11  * USE, DUPLICATION OR DISCLOSURE BY THE GOVERNMENT IS SUBJECT TO
	     12  * RESTRICTIONS AS SET FORTH IN SUBDIVISION (C)(1)(II) OF THE RIGHTS IN
	     13  * TECHNICAL DATA AND COMPUTER SOFTWARE CLAUSE AT DFARS 252.227-7013,
	     14  * AND/OR IN SIMILAR OR SUCCESSOR CLAUSES IN THE FAR, DOD OR NASA FAR
	     15  * SUPPLEMENT. UNPUBLISHED RIGHTS RESERVED UNDER THE COPYRIGHT LAWS OF
	     16  * THE UNITED STATES.  
	     17  * 
	     18  * COPYRIGHT 3DFX INTERACTIVE, INC. 1999, ALL RIGHTS RESERVED
	     19  */
	     20 
	     21 #include <sys/utsname.h>
	    677 #include <stdio.h>
	   1740 #include <string.h>
	   2191 
      1	   2192 int _cpu_detect_asm() {
      1	   2193   struct utsname name;
      1	   2194 
      1	   2195   uname(&name);
      1	   2196   if (!strcmp(name.machine, "i386")) return 3;
      1	   2197   if (!strcmp(name.machine, "i486")) return 4;
      1	   2198   if (!strcmp(name.machine, "i586")) return 5;
      1	   2199   if (!strcmp(name.machine, "i686")) return 6;
      1	   2200   fprintf(stderr, "Couldn't determine cpu type. Using i586\n");
      1	   2201   return 5;
      1	   2202 }
	   2203 
       X   2204 #ifdef __i386__
       X   2205 void single_precision_asm() {
       X   2206   asm("push %eax \n fnclex \n fstcw (%esp) \n movl (%esp), %eax \n "
       X   2207       "and $0x0000fcff, %eax \n movl %eax, (%esp) \n fldcw (%esp) \n pop %eax");
       X   2208 }
       X   2209 
       X   2210 
       X   2211 void double_precision_asm() {
       X   2212   asm("push %eax \n fnclex \n fstcw (%esp) \n movw (%esp), %eax \n "
       X   2213       "and $0x0000fcff, %eax \n or $0x000002ff, %eax \n mov %eax, (%esp) \n "
       X   2214       "fldcw (%esp) \n pop %eax");
       X   2215 }
       X   2216 #endif

CPUDETECT                       Source Listing                   9-MAY-2021 23:42:40  VSI C V7.4-002-50R2O              Page 2
V1.0                                                             8-MAY-2021 19:05:55  cpudetect.c;2

Command Line
------- ----

CC/DEBUG/NOOP/LIST=[.OUT.DEBUG.OBJ.GLIDE.GLIDE2X.CVG.GLIDE.SRC]CPUDETECT/OBJECT
=[.OUT.DEBUG.OBJ.GLIDE.GLIDE2X.CVG.GLIDE.SRC]CPUDETECT.OBJ/INCLUDE_DIRECTORY=([
.GLIDE.SWLIBS.FXMISC],[.GLIDE.GLIDE2X.CVG.INCSRC],[.GLIDE.GLIDE2X.CVG.GLIDE.SRC
],[.GLIDE.GLIDE2X.CVG.INIT],[.GLIDE.SWLIBS.NEWPCI.PCILIB])/DEFINE=(CVG,GLIDE_US
E_C_TRISETUP,GLIDE_HW_TRI_SETUP=1,GLIDE_TRI_CULLING=1,GLIDE_DEFAULT_GAMMA=1.3F,
GLIDE_LIB=1) [.GLIDE.GLIDE2X.CVG.GLIDE.SRC]CPUDETECT.C

Hardware: /ARCHITECTURE=GENERIC /OPTIMIZE=TUNE=GENERIC

These macros are in effect at the start of the compilation.
----- ------ --- -- ------ -- --- ----- -- --- ------------

 __G_FLOAT=1  __DECC=1  vms=1  VMS=1  __32BITS=1  __PRAGMA_ENVIRONMENT=1 
 __CRTL_VER=80400000  __vms_version="V8.4-2L1"  CC$gfloat=1  __X_FLOAT=1 
 GLIDE_HW_TRI_SETUP=1  GLIDE_USE_C_TRISETUP=1  vms_version="V8.4-2L1" 
 __DATE__="May  9 2021"  __STDC_VERSION__=199901L  __DECC_MODE_RELAXED=1 
 __DECC_VER=70490002  __VMS=1  GLIDE_DEFAULT_GAMMA=1.3F  GLIDE_LIB=1 
 __ALPHA=1  VMS_VERSION="V8.4-2L1"  __IEEE_FLOAT=0  __VMS_VERSION="V8.4-2L1" 
 __TIME__="23:42:40"  __Alpha_AXP=1  __VMS_VER=80421222 
 __BIASED_FLT_ROUNDS=2  CVG=1  __INITIAL_POINTER_SIZE=0  __STDC__=2 
 __LANGUAGE_C__=1  __vms=1  __alpha=1  __D_FLOAT=0  GLIDE_TRI_CULLING=1 

